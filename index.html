<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DApp untuk Korban Berinteraksi dengan Smart Contract</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/5.7.2/ethers.umd.min.js"></script>
</head>
<body>

<h1>Interact with Smart Contract as Victim</h1>

<!-- Connect Wallet Button -->
<button id="connectWallet">Connect Wallet</button>

<!-- Form to Check Balance -->
<h2>Check Balance</h2>
<form id="checkBalanceForm">
  <label for="checkAddress">Address:</label>
  <input type="text" id="checkAddress" name="checkAddress" required><br><br>
  
  <button type="submit">Check Balance</button>
</form>

<script>
  // Initialize ethers.js
  let provider, contract;
  const contractAddress = '0x8816e4c39472B5Ce851fB8cB271de419bF638f43';
  const contractABI = [
    {
      "inputs": [
        {
          "internalType": "address",
          "name": "account",
          "type": "address"
        }
      ],
      "name": "balanceOf",
      "outputs": [
        {
          "internalType": "uint256",
          "name": "",
          "type": "uint256"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    }
  ];

  // Function to connect wallet
  async function connectWallet() {
    if (window.ethereum) {
      try {
        await ethereum.request({ method: 'eth_requestAccounts' });
        provider = new ethers.providers.Web3Provider(window.ethereum);
        contract = new ethers.Contract(contractAddress, contractABI, provider);
        console.log('Connected to contract');
      } catch (err) {
        console.error(err);
      }
    } else {
      console.log('MetaMask not installed');
    }
  }

  // Check Balance Form Submit
  document.getElementById('checkBalanceForm').addEventListener('submit', async (e) => {
    e.preventDefault();
    const address = document.getElementById('checkAddress').value;

    try {
      const balance = await contract.balanceOf(address);
      console.log('Balance:', ethers.utils.formatUnits(balance, 18)); // Converting Wei to ETH
    } catch (err) {
      console.error(err);
    }
  });

  // Connect Wallet Button
  document.getElementById('connectWallet').addEventListener('click', connectWallet);
</script>

</body>
</html>
